<template>
<div class="container">
    <div id="alert-panel" :class="alert_class" role="alert" v-if="alert_show">
        {{alert_message}}
        <button type="button" class="btn-close" aria-label="Close" @click="alert_show = false"></button>
    </div>
    <form class="pass-form" @submit.prevent="submitForm">
        <div>
            <span class="lock-icon"><i class="bi bi-lock-fill"></i></span>
        </div>
        <div class="row mb-3">
            <label for="password"><h2 class="text-center">Forgot Password?</h2></label>
            <label for="password">You can reset you password here.</label>
        </div>
        <div class="input-group mt-3 mr-3 ml-3" style="width:400px !important;">
            <div class="input-group-prepend" style=" margin-left: 100px !important;">
                <span class="input-group-text" id="basic-addon1"><i class="bi bi-envelope"></i></span>
            </div>
            <input type="email" class="form-control" placeholder="email address" v-model="email" required>
        </div>
        <div class="row mb-3" style="margin-left: 100px; margin-right: 100px;">
            <button type="submit" class="btn btn-info mb-3 btn-reset" style="width:300px !important;"><span class="btn-text">Reset Password</span></button>
        </div>
    </form>
</div>

</template>

<script>
import { getAPI } from '../../axios-api'

export default {
    name:'UsersForgetPassword',
    data () {
        return {
            email: '',
            alert_show: false,
            alert_message: '',
            alert_class: '',
        }
    },
    methods: {
        async submitForm() {
            const dataArray = {
                email: this.email,
            }
            getAPI.post('users/resetPassword',dataArray)
            .then(response => {
                localStorage.setItem('code', response.data['data'])
                this.alert_show=true;
                this.alert_class = "alert alert-info alert-dismissible fade show";
                this.alert_message = response.data;                       
            })
            .catch(err => {
                console.log('reached to catch')
                console.log(err)
               this.alert_show=true;
               this.alert_class = "alert alert-danger alert-dismissible fade show";
               this.alert_message = err.response.data;             
            })

        },
        validateEmail(value){
            console.log('reached to validateEmail')
            if (/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(value)) {
                this.msg['email'] = 'Invalid Email Address';
            } else{
                this.msg['email'] = '';
            } 
        },
        validatePassword(value){
            let difference = 8 - value.length;
            if (value.length<8) {
                this.msg['password'] = 'Must be 8 characters! '+ difference + ' characters left' ;
            } else {
                this.msg['password'] = '';
            }
        },
    },
}
</script>

<style scoped>
.row {
   padding-top: 1rem !important;
}
.pass-form {
    border: 1px solid gray;
    border-radius: 10px;
    text-align: center;
    width: 500px;
    margin-left : 25vw;
    justify-content: center;
}
.btn-text {
    font-size: large;
    color: white;
}
.btn-reset {
    margin:auto;
    text-align: center;
}
.lock-icon {
    font-size: 84pt;
    color: rgb(170, 170, 175);
}
</style>